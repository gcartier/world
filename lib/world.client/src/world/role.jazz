;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; Roles
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2015
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.role jazz


(import (jazz.jml)
        (jazz.library)
        (world)
        (world.autoload)
        (world.syntax (phase syntax)))


;;;
;;;; Role
;;;


(definition public current-role
  #f)

(definition public (set-current-role role)
  (set! current-role role))


(definition public (user-role?)
  (eq? current-role 'user))

(definition public (designer-role?)
  (eq? current-role 'designer))

(definition public (programmer-role?)
  (eq? current-role 'programmer))

(definition public (admin-role?)
  (eq? current-role 'admin))


;;;
;;;; Traits
;;;


(class Role-Trait extends Trait)


(register-trait-tag 'Role-Trait))
