;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; Messages
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2016
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.message jazz


(definition protected (standardize-message message)
  (if (and (pair? message)
           (eq? (car message) '<span>))
      `(<span>
         ,@(map (lambda (par)
                  (if (string? par)
                      `(<paragraph> (<text> color: White ,par))
                    par))
                (cdr message)))
    `(<span>
       (<paragraph>
         (<text> color: White ,(->string message))))))


(class Message extends Object
  
  
  (slot time    getter generate)
  (slot sender  getter generate)
  (slot content getter generate)
  (slot size    getter generate)
  
  
  (method override (initialize time sender content size)
    (set! time~self time)
    (set! sender~self sender)
    (set! content~self content)
    (set! size~self size))
  
  
  (method override (print output readably)
    (print-unreadable self output
      (lambda (output)
        (format output "{a}" content))))))
