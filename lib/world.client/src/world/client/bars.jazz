;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Client Bars
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2018
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.client.bars jazz


(import (jazz.action)
        (jazz.markup)
        (jazz.resource)
        (jazz.ui)
        (world.interface.actions)
        (world.interface.blocks)
        (world.interface.showcase))


;;;
;;;; Main
;;;


(class World-Main-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Action-Button>    name: zone-new            resource: {Image-Resource "New"} action-handler: {Action world-zone zone-new})
      (<World-Action-Button>    name: zone-open           resource: {Image-Resource "Open"} action-handler: {Action world-zone zone-open})
      @YOWNU (<World-Parameter-Button> name: toggle-user         resource: {Image-Resource "Spy"} action-handler: {Action world-world toggle-user} parameter: user)
      (<World-Action-Button>    name: who-panel           resource: {Image-Resource "Spy"} action-handler: {Action world-world who-panel})
      (<World-Action-Button>    name: chat-panel          resource: {Image-Resource "Grab"} action-handler: {Action world-world chat-panel})
      (<World-Action-Button>    name: command-message     resource: {Image-Resource "Link"} action-handler: {Action world-world command-message})
      (<World-Action-Button>    name: main-menu           resource: {Image-Resource "View"} action-handler: {Action world-menu main-menu}))))


;;;
;;;; Interface
;;;


(class World-Interface-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: toggle-interface       resource: {Image-Resource "WorkspaceGroupware"} action-handler: {Action world-interface toggle-interface} parameter: interface)
      (<World-Parameter-Button> name: toggle-occlusion       resource: {Image-Resource "TypeRecord"} action-handler: {Action world-interface toggle-occlusion} parameter: occlusion)
      (<World-Parameter-Button> name: toggle-wireframe       resource: {Image-Resource "Project"} action-handler: {Action world-interface toggle-wireframe} parameter: wireframe)
      (<World-Action-Button>    name: run-script             resource: {Image-Resource "Script"} action-handler: {Action world-script run-script})
      (<World-Action-Button>    name: run-last-script        resource: {Image-Resource "Export"} action-handler: {Action world-script run-last-script}))))


;;;
;;;; Graphics
;;;


(class World-Graphics-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                               title: "Graphics"
      (<World-Parameter-Button> name: toggle-glow            resource: {Image-Resource "Link"} action-handler: {Action world-graphics toggle-glow} parameter: glow)
      (<World-Parameter-Button> name: toggle-lighting        resource: {Image-Resource "ProcessDead"} action-handler: {Action world-graphics toggle-lighting} parameter: lighting)
      (<World-Parameter-Button> name: toggle-fog             resource: {Image-Resource "Architecture"} action-handler: {Action world-graphics toggle-fog} parameter: fog)
      (<World-Parameter-Button> name: toggle-gadgets         resource: {Image-Resource "Gray"} action-handler: {Action world-graphics toggle-gadgets} parameter: gadgets)
      (<World-Parameter-Button> name: toggle-normals         resource: {Image-Resource "FullScreen"} action-handler: {Action world-graphics toggle-normals} parameter: normals)
      (<World-Parameter-Button> name: toggle-x-rays          resource: {Image-Resource "Spy"} action-handler: {Action world-graphics toggle-x-rays} parameter: x-rays)
      (<World-Parameter-Button> name: toggle-redstone-x-rays resource: {Image-Resource "Red"} action-handler: {Action world-graphics toggle-redstone-x-rays} parameter: redstone-x-rays)
      (<World-Parameter-Button> name: toggle-blocks          resource: {Image-Resource "Symbol"} action-handler: {Action world-graphics toggle-blocks} parameter: blocks)
      (<World-Parameter-Button> name: toggle-models          resource: {Image-Resource "Model"} action-handler: {Action world-graphics toggle-models} parameter: models)
      (<World-Parameter-Button> name: toggle-post-processing resource: {Image-Resource "Build"} action-handler: {Action world-graphics toggle-post-processing} parameter: post-processing))))


;;;
;;;; Client
;;;


(class World-Client-Bar extends World-Actionbar
  
  
  (form
    (<install>)))


;;;
;;;; Camera
;;;


(class World-Camera-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                                title: "Camera"
      (<World-Parameter-Button> name: person-motion           resource: {Image-Resource "MsgUser"} action-handler: {Action world-camera person-motion} parameter: person-motion)
      (<World-Parameter-Button> name: orbit-motion            resource: {Image-Resource "WebServer"} action-handler: {Action world-camera orbit-motion} parameter: orbit-motion)
      (<World-Parameter-Button> name: free-motion             resource: {Image-Resource "Empty"} action-handler: {Action world-camera free-motion} parameter: free-motion)
      (<World-Parameter-Button> name: toggle-camera-smoothing resource: {Image-Resource "Spy"} action-handler: {Action world-camera toggle-camera-smoothing} parameter: camera-smoothing)
      (<World-Parameter-Button> name: toggle-camera-follow    resource: {Image-Resource "DesignRelation"} action-handler: {Action world-camera toggle-camera-follow} parameter: camera-follow)
      (<World-Parameter-Button> name: toggle-cursor-mode      resource: {Image-Resource "ModeSelect"} action-handler: {Action world-camera toggle-cursor-mode} parameter: cursor-mode))))


;;;
;;;; Game
;;;


(class World-Game-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Ongoing-Button>   name: bullet              resource: {Image-Resource "Red"} action-handler: {Action world-spell bullet} key: #\1)
      (<World-Ongoing-Button>   name: arrow               resource: {Image-Resource "Blue"} action-handler: {Action world-spell arrow} key: #\2)
      (<World-Ongoing-Button>   name: sprint              resource: {Image-Resource "Field"} action-handler: {Action world-spell sprint} key: #\3)
      (<World-Ongoing-Button>   name: blink               resource: {Image-Resource "Constructor"} action-handler: {Action world-spell blink} key: #\4)
      (<World-Ongoing-Button>   name: warp                resource: {Image-Resource "Link"} action-handler: {Action world-spell warp} key: #\5)
      (<World-Parameter-Button> name: dash                resource: {Image-Resource "Threads"} action-handler: {Action world-spell dash} parameter: dash)
      (<World-Parameter-Button> name: mind-control        resource: {Image-Resource "Designer"} action-handler: {Action world-game mind-control} parameter: mind-control)
      @YOWNU (<World-Parameter-Button> name: toggle-aim          resource: {Image-Resource "ShowInvisibles"} action-handler: {Action world-game toggle-aim} parameter: aim)
      @YOWNU (<World-Parameter-Button> name: toggle-free-aim     resource: {Image-Resource "FullScreen"} action-handler: {Action world-game toggle-free-aim} parameter: free-aim)
      (<World-Parameter-Button> name: toggle-ride         resource: {Image-Resource "Navigator"} action-handler: {Action world-game toggle-ride} parameter: ride)
      (<World-Parameter-Button> name: toggle-fly          resource: {Image-Resource "OfferDestination"} action-handler: {Action world-game toggle-fly} parameter: fly)
      (<World-Parameter-Button> name: character-panel     resource: {Image-Resource "MsgUser"} action-handler: {Action world-game character-panel} parameter: character-panel)
      (<World-Parameter-Button> name: bag-panel           resource: {Image-Resource "Toolbox"} action-handler: {Action world-game bag-panel} parameter: bag-panel))))


;;;
;;;; Showcase
;;;


(class World-Showcase-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                            title: "Showcase"
      (<World-Parameter-Button> name: no-showcase         resource: {Icon-Resource "Interface/No-Showcase"} action-handler: {Action world-showcase no-showcase} parameter: no-showcase)
      (<World-Parameter-Button> name: blocks-showcase     resource: {Icon-Resource "Interface/Blocks-Showcase"} action-handler: {Action world-showcase blocks-showcase} parameter: blocks-showcase)
      (<World-Parameter-Button> name: models-showcase     resource: {Icon-Resource "Interface/Models-Showcase"} action-handler: {Action world-showcase models-showcase} parameter: models-showcase)
      (<World-Parameter-Button> name: gadgets-showcase    resource: {Icon-Resource "Interface/Gadgets-Showcase"} action-handler: {Action world-showcase gadgets-showcase} parameter: gadgets-showcase)
      (<World-Parameter-Button> name: avatars-showcase    resource: {Image-Resource "MsgUser"} action-handler: {Action world-showcase avatars-showcase} parameter: avatars-showcase)
      (<World-Parameter-Button> name: tiles-showcase      resource: {Image-Resource "MsgPaint"} action-handler: {Action world-showcase tiles-showcase} parameter: tiles-showcase)
      (<World-Parameter-Button> name: shaders-showcase    resource: {Image-Resource "Link"} action-handler: {Action world-showcase shaders-showcase} parameter: shaders-showcase)
      (<World-Parameter-Button> name: animations-showcase resource: {Image-Resource "Threads"} action-handler: {Action world-showcase animations-showcase} parameter: animations-showcase)
      (<World-Parameter-Button> name: meshes-showcase     resource: {Image-Resource "Library"} action-handler: {Action world-showcase meshes-showcase} parameter: meshes-showcase)
      (<World-Parameter-Button> name: textures-showcase   resource: {Image-Resource "Image"} action-handler: {Action world-showcase textures-showcase} parameter: textures-showcase)
      (<World-Parameter-Button> name: skyboxes-showcase   resource: {Image-Resource "Grab"} action-handler: {Action world-showcase skyboxes-showcase} parameter: skyboxes-showcase))))


;;;
;;;; Edition
;;;


(class World-Edition-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: toggle-grid             resource: {Image-Resource "Tile"} action-handler: {Action world-edition toggle-grid} parameter: grid)
      (<World-Action-Button>    name: change-editor-mode      resource: {Image-Resource "ImportRules"} action-handler: {Action world-edition change-editor-mode}))))


;;;
;;;; Target
;;;


(class World-Target-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                             title: "Target"
      (<World-Parameter-Button> name: select-target-mode   resource: {Image-Resource "Empty"} action-handler: {Action world-target select-target-mode} parameter: select-target-mode)
      (<World-Parameter-Button> name: move-target-mode     resource: {Image-Resource "ClassConstructor"} action-handler: {Action world-target move-target-mode} parameter: move-target-mode)
      (<World-Parameter-Button> name: rotate-target-mode   resource: {Image-Resource "JemUpdateCategories"} action-handler: {Action world-target rotate-target-mode} parameter: rotate-target-mode)
      (<World-Parameter-Button> name: scale-target-mode    resource: {Image-Resource "FullScreen"} action-handler: {Action world-target scale-target-mode} parameter: scale-target-mode)
      (<World-Parameter-Button> name: skeleton-target-mode resource: {Image-Resource "DesignRelations"} action-handler: {Action world-target skeleton-target-mode} parameter: skeleton-target-mode))))


;;;
;;;; Models
;;;


(class World-Models-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Action-Button> name: import-model resource: {Image-Resource "Import"} action-handler: {Action world-edition import-model}))))


;;;
;;;; Blocks
;;;


(class World-Blocks-Bar extends World-Showcase-Categories-Bar
  
  
  (form
    (<install> background: #f
      (<Block-Category-Icon> name: building)
      (<Block-Category-Icon> name: wood)
      (<Block-Category-Icon> name: decoration)
      (<Block-Category-Icon> name: plants)
      (<Block-Category-Icon> name: wool)
      (<Block-Category-Icon> name: redstone)
      @w
      (<Block-Category-Icon> name: waiting)
      (<Block-Category-Icon> name: sloped)))
  
  
  (method override (bar-height self)
    52)
  
  
  (method override (layout self)
    (nextmethod self)
    (let ((decoration (child self 'decoration)))
      (set-position decoration (nu+ (get-position decoration) {Point 2 0})))))


;;;
;;;; Media
;;;


(class World-Media-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: toggle-music           resource: {Image-Resource "Grab"} action-handler: {Action world-sound toggle-music} parameter: music)
      (<World-Parameter-Button> name: toggle-ambience        resource: {Image-Resource "Link"} action-handler: {Action world-sound toggle-ambience} parameter: ambience)
      (<World-Parameter-Button> name: toggle-sound           resource: {Image-Resource "BlueRed"} action-handler: {Action world-sound toggle-sound} parameter: sound))))


;;;
;;;; History
;;;


(class World-History-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                               title: "History"
      (<World-Parameter-Button> name: toggle-paused          resource: {Image-Resource "Pause"} action-handler: {Action world-history toggle-paused} parameter: paused)
      (<World-Action-Button>    name: backward-history       resource: {Image-Resource "Backward"} action-handler: {Action world-history backward-history})
      (<World-Action-Button>    name: forward-history        resource: {Image-Resource "Forward"} action-handler: {Action world-history forward-history})
      (<World-Action-Button>    name: reset-history          resource: {Image-Resource "ClearResults"} action-handler: {Action world-history reset-history})
      (<World-Parameter-Button> name: toggle-evaluate-future resource: {Image-Resource "Constructor"} action-handler: {Action world-history toggle-evaluate-future} parameter: evaluate-future)
      (<World-Action-Button>    name: step-backward          resource: {Image-Resource "StepRewind"} action-handler: {Action world-history step-backward})
      (<World-Action-Button>    name: step-forward           resource: {Image-Resource "StepInto"} action-handler: {Action world-history step-forward})
      (<World-Action-Button>    name: step-over              resource: {Image-Resource "StepOver"} action-handler: {Action world-history step-over})
      ;; quick hack to make it invisible
      (<Label-View>             name: at-logic               size: {Dimension 100 20} justification: center visible?: #f))))


;;;
;;;; Window
;;;


(class World-Window-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: toggle-windowed-mode resource: {Image-Resource "Window"} action-handler: {Action world-window toggle-windowed-mode} parameter: windowed-mode)
      (<World-Action-Button>    name: live-gaia/world      resource: {Image-Resource "Script"} action-handler: {Action world-window live-gaia/world})
      (<World-Action-Button>    name: design-gaia/world    resource: {Image-Resource "Sorcerer"} action-handler: {Action world-window design-gaia/world})
      (<World-Action-Button>    name: restore-gaia/world   resource: {Image-Resource "Cancel"} action-handler: {Action world-window restore-gaia/world}))))


;;;
;;;; Debug
;;;


(class World-Debug-Menu extends World-Radial-Menu
  
  
  (form
    (<install>                                                title: "Debug"
      (<World-Parameter-Button> name: toggle-info             resource: {Icon-Resource "Web and Apps/Light"} action-handler: {Action world-debug toggle-info} parameter: info)
      (<World-Parameter-Button> name: toggle-profiler         resource: {Icon-Resource "Audio/Specifics"} action-handler: {Action world-debug toggle-profiler} parameter: profiler)
      (<World-Action-Button>    name: reset-profiling         resource: {Image-Resource "Refresh"} action-handler: {Action world-debug reset-profiling})
      (<World-Parameter-Button> name: toggle-timeline         resource: {Icon-Resource "Audio/Music-Specifics"} action-handler: {Action world-debug toggle-timeline} parameter: timeline)
      (<World-Parameter-Button> name: toggle-target           resource: {Image-Resource "Model"} action-handler: {Action world-debug toggle-target} parameter: target)
      (<World-Parameter-Button> name: toggle-script           resource: {Image-Resource "Script"} action-handler: {Action world-debug toggle-script} parameter: script)
      (<World-Parameter-Button> name: toggle-axes             resource: {Image-Resource "Configure"} action-handler: {Action world-debug toggle-axes} parameter: axes)
      (<World-Parameter-Button> name: toggle-orientation      resource: {Image-Resource "Spy"} action-handler: {Action world-debug toggle-orientation} parameter: orientation)
      (<World-Parameter-Button> name: toggle-debug-sectors    resource: {Image-Resource "Process"} action-handler: {Action world-debug toggle-debug-sectors} parameter: debug-sectors)
      (<World-Parameter-Button> name: toggle-debug-areas      resource: {Image-Resource "ProcessDead"} action-handler: {Action world-debug toggle-debug-areas} parameter: debug-areas)
      (<World-Parameter-Button> name: toggle-draw-atlas       resource: {Image-Resource "TypeRecord"} action-handler: {Action world-debug toggle-draw-atlas} parameter: draw-atlas)
      (<World-Parameter-Button> name: toggle-draw-me          resource: {Image-Resource "MsgUser"} action-handler: {Action world-debug toggle-draw-me} parameter: draw-me)
      (<World-Action-Button>    name: change-missile-behavior resource: {Image-Resource "Present"} action-handler: {Action world-debug change-missile-behavior})
      (<World-Action-Button>    name: reset-marks             resource: {Image-Resource "Refresh"} action-handler: {Action world-debug reset-marks})
      (<World-Action-Button>    name: clear-terminal          resource: {Icon-Resource "Photography UI/No-Flash"} action-handler: {Action world-debug clear-terminal})
      (<World-Action-Button>    name: clear-console           resource: {Icon-Resource "Created/RedX"} action-handler: {Action world-debug clear-console})
      (<World-Action-Button>    name: garbage-collect         resource: {Image-Resource "Link"} action-handler: {Action world-debug garbage-collect})
      (<World-Action-Button>    name: explore-interface       resource: {Icon-Resource "Games/Visual"} action-handler: {Action world-debug explore-interface}))))


;;;
;;;; Tutorial
;;;


(class World-Tutorial-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: display-objectives resource: {Image-Resource "ServerRunning"} action-handler: {Action world-tutorial display-objectives} parameter: objectives)
      (<World-Action-Button>    name: skip-objective     resource: {Image-Resource "StepOver"} action-handler: {Action world-tutorial skip-objective})
      (<World-Action-Button>    name: restart-tutorial   resource: {Image-Resource "Link"} action-handler: {Action world-tutorial restart-tutorial})
      (<World-Action-Button>    name: exit-tutorial      resource: {Image-Resource "Home"} action-handler: {Action world-tutorial exit-tutorial}))))


;;;
;;;; Objective
;;;


(class World-Objective-Bar extends World-Actionbar
  
  
  (form
    (<install>
      (<World-Parameter-Button> name: open-template resource: {Image-Resource "Architecture"} action-handler: {Action world-objective open-template} parameter: tutorial-template)
      (<World-Action-Button>    name: save-template resource: {Image-Resource "SaveDesign"} action-handler: {Action world-objective save-template})
      (<World-Action-Button>    name: copy-block    resource: {Image-Resource "Symbol"} action-handler: {Action world-objective copy-block})
      (<World-Action-Button>    name: copy-polygon  resource: {Image-Resource "Tile"} action-handler: {Action world-objective copy-polygon})))))
