;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Tests
;;;


(module world.test jazz


;;;
;;;; Collision
;;;


(import (world.collision)
        (world.geometry)
        (world.plane)
        (world.polygon))


(define (polygon . vertices)
  (bind (v1 v2 v3) vertices
    (new Polygon vertices (new Plane
                            (triangle-center v1 v2 v3)
                            (plane-normal v1 v2 v3)))))


(definition public (test)
  (let ((sphere-radius 1.)
        (polygon-list (list (polygon (vertex 0. 0. 0.) (vertex 5. 0. 0.) (vertex 2.5 2.5 -5.5))))
        (movement (new Movement (vertex 0.0 0.5 5.) (vertex 0. 0. -10.)))
        (last-direction #f)
        (filter-pulse-jumps #f))
    (debug sphere-radius: sphere-radius)
    (debug polygon-list: polygon-list)
    (debug movement: movement)
    (receive (cl hit) (collide-and-slide sphere-radius
                                         polygon-list
                                         movement
                                         last-direction
                                         filter-pulse-jumps)
      (debug 'cl '-> cl)
      (debug 'hit '-> hit)))))
