;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Panes
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2013
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.interface.pane jazz


(import (jazz.ui)
        (world)
        (world.autoload)
        (world.syntax (phase syntax)))


;;;
;;;; World-Pane
;;;


(class World-Pane extends Layout-View
  
  
  (slot moving?        initialize #f)
  (slot start-mouse    initialize #f)
  (slot start-position initialize #f)
  
  
  (method (move-pane-down origin pos)
    (set! moving? #t)
    (set! start-mouse (acquire~ (get-interface~ (current-world)) origin pos))
    (set! start-position (get-position))
    (acquire-capture~ origin))
  
  
  (method (move-pane-drag origin pos)
    (when moving?
      (let ((delta (nu- (acquire~ (get-interface~ (current-world)) origin pos) start-mouse)))
        (let ((pos (nu+ start-position delta)))
          (set-location (list (get-h~ pos) (get-v~ pos)))
          (set-position (nu+ start-position delta))))))
  
  
  (method (move-pane-up origin pos)
    (when moving?
      (release-capture~ origin)
      (set! moving? #f)))))
