;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Actions
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2013
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.interface.actions jazz


(import (jazz.io)
        (jazz.jml)
        (jazz.graphic)
        (jazz.graphic.opengl.glew)
        (jazz.library)
        (jazz.literals)
        (jazz.platform)
        (jazz.platform.cairo)
        (jazz.system)
        (jazz.ui)
        (jazz.ui.view)
        (world)
        (world.autoload)
        (world.interface)
        (world.interface.pane)
        (world.parameters)
        (world.syntax (phase syntax)))


;;;
;;;; World-Actionbar
;;;


(class World-Actionbar extends World-Pane
  
  
  (form
    (<install> background: {Color Medium alpha: .75} layout-type: flow layout-padding: 2))
  
  
  (method override (draw-background surface context)
    (let ((world (current-world)))
      (when (get-interface-bars?~ world)
        (nextmethod surface context))))
  
  
  (method override (draw-children surface nodes context)
    (let ((world (current-world)))
      (when (get-interface-bars?~ world)
        (nextmethod surface nodes context)))))


;;;
;;;; World-Action-Button
;;;


(class World-Action-Button extends Action-Icon
  

  (property selected? initialize #f accessors explicit)
  
  
  ;;;
  ;;;; Drawing
  ;;;
  
  
  (method override (draw-frame surface)
    (define frame-color
      {Color red: .938 green: .938 blue: .005})
    
    (if (and selected? (memq? (get-state) '(inactive highlighted out-pushed)))
        (draw-border surface frame-color frame-color)
      (nextmethod surface)))
  
  
  ;;;
  ;;;; Selected
  ;;;


  (method public (get-selected?)
    selected?)


  (method public (set-selected? flag)
    (when (neq? flag selected?)
      (set! selected? flag)
      (invalidate-view))))


;;;
;;;; World-Parameter-Button
;;;


(class World-Parameter-Button extends Action-Icon
  
  
  (property parameter initialize #f accessors generate)
  
  
  ;;;
  ;;;; Drawing
  ;;;
  
  
  (method override (draw-frame surface)
    (define frame-color
      {Color red: .938 green: .938 blue: .005})
    
    (if (world-parameter parameter)
        (draw-border surface frame-color frame-color)
      (nextmethod surface)))))
