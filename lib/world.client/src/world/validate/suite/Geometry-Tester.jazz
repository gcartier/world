;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; Geometry Tests
;;;


(module protected world.validate.suite.Geometry-Tester jazz


(import (jazz.jml)
        (jazz.locale)
        (jazz.validation)
        (world.geometry))


(class Geometry-Tester extends Tester
  
  
  (form
    (<install> title: "Geometry"))


  (method override (test)
    (invoke "aaa" test-cross-product))
  
  
  ;;;
  ;;;; cross-product
  ;;;


  (method (test-cross-product)
    (let ((x (vertex 1. 0. 0.))
          (y (vertex 0. 1. 0.))
          (z (vertex 0. 0. 1.))
          (sight (vertex 0. 0. -1.))
          (up (vertex 0. 1. 0.))
          (right (vertex 1. 0. 0.)))
      ;; axis
      (validate (vertex=? (cross-product x y) z))
      (validate (vertex=? (cross-product y x) (vertex-negate z)))
      
      ;; lookat
      (validate (vertex=? (cross-product sight up) right))))))
