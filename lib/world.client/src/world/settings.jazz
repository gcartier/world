;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Settings
;;;


(module world.settings jazz


(import (jazz.io)
        (jazz.library)
        (jazz.library.template)
        (jazz.snapshot)
        (jazz.system))


;;;
;;;; Settings
;;;


(definition public (copy-settings-if-not-exists)
  (unless (exists?~ {Directory Home ".world"})
    (copy-template (new-directory~ (world-templates-directory) "settings")
                   {Directory Home}
                   '())))


;;;
;;;; Pathnames
;;;


(definition (world-alias)
  (if (is-alias? 'World)
      'World
    'Build))


(definition public (world-file path (alias #f))
  (new-file~ (new Directory (list (or alias (world-alias))))
    path))


(definition public (world-directory path (alias #f))
  (new-directory~ (new Directory (list (or alias (world-alias))))
    path))


;;;
;;;; Templates
;;;


(definition public (world-templates-directory (alias #f))
  (world-directory '("devel" "templates") alias))


;;;
;;;; Snapshots
;;;


(definition public (setup-snapshots)
  (snapshots-directory {Directory Settings "crashes"})
  (snapshot-max-depth 3)
  (snapshot-max-width 32768)))
