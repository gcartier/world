;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; Mobile Server
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2018
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.server.mobile jazz


(import (jazz.network)
        (world)
        (world.settings))


(definition package mobile-server
  #f)

(definition package mobile-service-offset
  99)


(definition package (start-mobile-server)
  (let ((configuration (get-server-configuration)))
    (let ((host (get-host configuration))
          (service (+ (get-service configuration) mobile-service-offset)))
      (let ((server (new Mobile-Server host: host service: service)))
        (start server)
        (set! mobile-server server)))))


(definition package (stop-mobile-server)
  (when mobile-server
    (stop mobile-server)
    (set! mobile-server #f)))


(class Mobile-Server extends TCP-Server
  
  
  (method override (server-name self)
    'mobile-server)
  
  
  (method override (connection-name self)
    'mobile-connection)

  
  ;;;
  ;;;; Connection
  ;;;
  
  
  (method override (accept-connection self port)
    (terminal 'hey 'stop 'that!))))
