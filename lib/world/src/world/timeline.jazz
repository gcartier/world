;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Timeline
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2018
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.timeline jazz


(import (world)
        (world.chronology)
        (world.context)
        (world.evolution)
        (world.udp))


(proclaim (not check bounds zero)
          (warn optimizations))

(declare (optimize-dead-local-variables))


(class Timeline extends Object


  (slot title        getter generate)
  (slot directory    getter generate)
  (slot tier         accessors generate)
  (slot names        getter generate)
  (slot metadatas    getter generate)
  (slot chronologies getter generate)
  (slot evolutions   getter generate)
  (slot audios       getter generate)
  (slot videos       getter generate)
  (slot base-time    getter generate)
  
  
  (method override (initialize self title directory tier names metadatas chronologies evolutions audios videos base-time)
    (nextmethod self)
    (set! self.title title)
    (set! self.directory directory)
    (set! self.tier tier)
    (set! self.names names)
    (set! self.metadatas metadatas)
    (set! self.chronologies chronologies)
    (set! self.evolutions evolutions)
    (set! self.audios audios)
    (set! self.videos videos)
    (set! self.base-time base-time))
  
  
  (method public (name-ref self tier)
    (table-ref names tier))
  
  
  (method public (metadata-ref self tier)
    (table-ref metadatas tier))
  
  
  (method public (chronology-ref self tier)
    (table-ref chronologies tier))
  
  
  (method public (evolution-ref self tier)
    (table-ref evolutions tier))
  
  
  (method public (audio-ref self tier)
    (and audios (table-ref audios tier #f)))
  
  
  (method public (video-ref self tier)
    (and videos (table-ref videos tier #f))))


(definition timeline <Timeline>
  (new Timeline
    #f
    #f
    #f
    #f
    #f
    (list (current-chronology))
    (list (current-evolution))
    #f
    #f
    #f))


(definition public inline (current-timeline) <Timeline>
  timeline))
