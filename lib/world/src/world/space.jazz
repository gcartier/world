;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Spaces
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2018
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.space jazz


(import (jazz.action)
        (jazz.application)
        (jazz.component)
        (jazz.geometry)
        (gaea.geometry)
        (world)
        (world.actor)
        (world.autoload)
        (world.change)
        (world.context)
        (world.creature)
        (world.element)
        (world.entity)
        (world.generation)
        (world.generation.block)
        (world.generation.building)
        (world.generation.decoration)
        (world.generation.redstone)
        (world.generation.vegetation)
        (world.history)
        (world.index)
        (world.interface.inventory)
        (world.polygon)
        (world.redstone)
        (world.settings)
        (world.sound)
        (world.spawn)
        (world.syntax (phase syntax))
        (world.travel))


(definition protected *space-actions*
  '())


(definition protected (set-space-actions actions-list)
  (update-actions-shortcuts (current-application) *space-actions* actions-list)
  (set! *space-actions* actions-list))


;;;
;;;; Space
;;;


(class Space extends Object
  
  
  (slot root initialize #f getter generate)
  
  
  (method protected virtual (space-name self)
    )
  
  
  (method protected virtual (space-setup self)
    )
  
  
  (method protected virtual (space-install self)
    )
  
  
  (method protected virtual (space-activate self)
    (let ((traits (space-bindings self)))
      (when (not-null? traits)
        (replace-active-traits (current-bindings) (append (role-bindings (current-application)) traits))))
    (set-space-actions (space-actions self)))
  
  
  (method protected virtual (space-deactivate self)
    (set-space-actions '())
    (let ((traits (space-bindings self)))
      (when (not-null? traits)
        (replace-active-traits (current-bindings) (role-bindings (current-application))))))
  
  
  (method protected (space-refresh self)
    (set-space-actions '())
    (let ((traits (space-bindings self)))
      (when (not-null? traits)
        (replace-active-traits (current-bindings) (append (role-bindings (current-application)) traits))))
    (set-space-actions (space-actions self)))
  
  
  (method protected virtual (space-uninstall self)
    )
  
  
  (method protected virtual (space-bindings self)
    '())
  
  
  (method protected virtual (space-actions self)
    '())
  
  
  (method protected virtual (application-activate self)
    )
  
  
  (method protected virtual (application-deactivate self)
    )
  
  
  (method protected virtual (receive-files self pos pathnames)
    )
  
  
  (method protected virtual (mainbar-show self)
    )
  
  
  (method protected virtual (mainbar-hide self)
    )
  
  
  (method protected virtual (fade-mainbar? self)
    #f)
  
  
  (method protected virtual (maybe-fade-mainbar self)
    )
  
  
  (method protected virtual (central-menu-show self)
    )
  
  
  (method protected virtual (central-menu-hide self)
    #f)
  
  
  (method protected virtual (panel-stack-change self)
    )
  
  
  (method protected virtual (showcase-change self)
    )
  
  
  (method protected virtual (zone-change self zone)
    )
  
  
  (method protected virtual (showcase-avatar? self)
    #f)
  
  
  (method protected virtual (showcase-avatar-y self avatar)
    #f)
  
  
  (method protected virtual (showcase-avatar-scaling self avatar)
    #f)
  
  
  (method protected virtual (showcase-avatars? self)
    #t)
  
  
  (method protected virtual (showcase-avatars-vertical self)
    #f)
  
  
  (method protected virtual (showcase-avatars-double-click self h v)
    )
  
  
  (method protected virtual (show-me? self)
    #t)
  
  
  (method protected virtual (only-skybox self)
    #f)
  
  
  (method protected virtual (draw-world? self)
    #t)
  
  
  (method protected virtual (draw-skybox? self)
    #t)
  
  
  (method protected virtual (draw-horizon? self)
    (draw-world? self))
  
  
  (method protected virtual (draw-compass? self)
    (draw-world? self))
  
  
  (method protected virtual (draw-message-offset self)
    #f)
  
  
  (method protected virtual (draw-working-offset self)
    #f)
  
  
  ;;;
  ;;;; Keyboard
  ;;;
  
  
  (method protected virtual (enter-press self)
    )
  
  
  (method protected virtual (tab-press self)
    )
  
  
  (method protected virtual (escape-press self)
    #f)
  
  
  ;;;
  ;;;; Mouse
  ;;;
  
  
  (method package virtual (mouse-down self h v)
    )
  
  
  (method package virtual (mouse-up self h v)
    )
  
  
  (method package virtual (right-mouse-up self h v)
    )
  
  
  (method package virtual (mouse-action self h v)
    )
  
  
  (method package virtual (mouse-moved self x y)
    )
  
  
  (method package virtual (mouse-track self dx dy)
    #f)
  
  
  (method package virtual (double-click self h v)
    )
  
  
  (method package virtual (multiple-click self h v)
    )))
