;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Sun
;;;


(module world.sun jazz


(import (jazz.jml)
        (jazz.graphic)
        (jazz.graphic.opengl.glew)
        (world)
        (world.autoload)
        (world.draw)
        (world.dye)
        (world.element)
        (world.entity)
        (world.foreign)
        (world.gadget)
        (world.generate)
        (world.geometry)
        (world.material)
        (world.model)
        (world.object)
        (world.shader)
        (world.syntax (phase syntax)))


;;;
;;;; Sun
;;;


(class Sun extends Entity
  
  
  (method override (prepare rest)
    (nextmethod rest)
    (set-size (vertex 100.0 100.0 100.0))
    (set-color (dye .964 .859 .005 1.)))
  
  
  (method override (finish rest)
    (nextmethod rest)
    (let ((world (current-world)))
      (let ((material (new Material texture: (find-texture~ world "dirty.png"))))
        (set! model (new Model mesh: (generate-sphere 48 24 material: material)))
        (update-matrix))))
  
  
  (method override (element-radius)
    50.)
  
  
  (method override (entity-program)
    'color)
  
  
  (method override (entity-bind-uniforms program mesh matrix)
    (bind-uniforms~ program mesh matrix color))))
