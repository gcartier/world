;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; Wavefront Obj
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2013
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.external.obj jazz


(import (world.foreign.obj)
        (world.material)
        (world.mesh)
        (world.model))


;;;
;;;; Obj
;;;


(definition public (load-obj file texture)
  (let ((model (new Model)))
    (let ((mesh (new Mesh))
          (content (parse-obj (parse~ file))))
      (allocate-vertices~ mesh)
      (set-data~ (get-vertices-buffer~ mesh) content (f32vector-length content) 9)
      (set-material~ mesh (new Material texture: texture))
      (set-meshes~ model (vector mesh)))
    model)))
