;;;==============
;;;  JazzScheme
;;;==============
;;;
;;;; World Geometry Syntax
;;;


(module world.geometry.syntax jazz


;;;
;;;; F32
;;;


(syntax public make-f32&
  (lambda (form-src usage-environment macro-environment)
    (sourcify-if
      `(static (make-f32))
      form-src)))


;;;
;;;; Vertex
;;;


(syntax public make-vertex&
  (lambda (form-src usage-environment macro-environment)
    (sourcify-if
      `(static (make-vertex))
      form-src)))


(syntax public vertex+&
  (lambda (form-src usage-environment macro-environment)
    (let ((rest (cdr (source-code form-src))))
      (sourcify-if
        `(vertex+! (make-vertex&) ,@rest)
        form-src)))))
