;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Asset
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2016
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.asset jazz


(import (jazz.io))


(class Asset extends Object
  
  
  (slot assets getter generate)
  (slot spine  getter generate)
  
  
  (method override (initialize assets spine)
    (set! assets~self assets)
    (set! spine~self spine))
  
  
  (method override (print output readably)
    (print-unreadable self output
      (lambda (output)
        (format output "{l}" spine))))
  
  
  (method public (get-name)
    (last spine))
  
  
  (method public (get-base)
    (extract-base (get-name)))
  
  
  (method public (get-unique-spine (extension #f))
    (let ((unique-spine (append (get-unique-spine~ assets) spine)))
      (if (not extension)
          unique-spine
        (append (butlast unique-spine) (list (add-extension (last unique-spine) extension))))))
  
  
  (method public (make-brother extension)
    (make-file~ assets (append (butlast spine) (list (add-extension (last spine) extension)))))))
