;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Settings
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2015
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.settings jazz


(import (jazz.io)
        (jazz.library.template)
        (jazz.snapshot)
        (jazz.system))


;;;
;;;; Settings
;;;


(definition public (world-setting name default)
  (user-setting name default 'default))


(definition public (copy-settings-if-not-exists settings-root (alias #f))
  (unless (exists?~ settings-root)
    (copy-template (new-directory~ (world-templates-directory alias) "settings")
                   {Directory Home}
                   '())))


;;;
;;;; Pathnames
;;;


(definition public (world-alias)
  (if (is-alias? 'World)
      'World
    'Build))


(definition public (world-file path (alias #f))
  (new-file~ (new Directory (list (or alias (world-alias))))
    path))


(definition public (world-directory path (alias #f))
  (new-directory~ (new Directory (list (or alias (world-alias))))
    path))


;;;
;;;; Templates
;;;


(definition public (world-templates-directory (alias #f))
  (world-directory '("devel" "templates") alias))


;;;
;;;; Snapshots
;;;


(definition public (setup-snapshots)
  (snapshots-directory {Directory Settings "work" "crashes"})
  (snapshot-max-depth 3)
  (snapshot-max-width 32768)))
