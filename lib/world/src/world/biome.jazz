;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Biomes
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2016
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.biome jazz


(import (jazz.geometry)
        (jazz.graphic)
        (world)
        (world.autoload)
        (world.geometry)
        (world.syntax (phase syntax)))


;;;
;;;; Biome
;;;


(class Biome extends Object
  
  
  (slot name        getter generate)
  (slot title       getter generate)
  (slot id          getter generate)
  (slot top         accessors generate)
  (slot fill        accessors generate)
  (slot color       getter generate)
  (slot base        getter generate)
  (slot variation   getter generate)
  (slot temperature getter generate)
  (slot rain        getter generate)
  
  
  (method override (initialize name title id top fill color base variation temperature rain)
    (set! name~self name)
    (set! title~self title)
    (set! id~self id)
    (set! top~self top)
    (set! fill~self fill)
    (set! color~self color)
    (set! base~self base)
    (set! variation~self variation)
    (set! temperature~self temperature)
    (set! rain~self rain))
  
  
  (method override (print output readably)
    (print-unreadable self output
      (lambda (output)
        (format output "{a}" name)))))


(definition protected biome-names <table>
  (make-table test: eq?))

(definition protected biome-ids <vector>
  (make-vector 256 #f))


(definition protected (register-biome name class title id top fill color (base: base 0.1) (variation: variation 0.2) (temperature: temperature 0.5) (rain: rain 0.5))
  (bind (red green blue) color
    (let ((color (new Color red: red green: green blue: blue)))
      (let ((biome (new Biome name title id top fill color base variation temperature rain)))
        (table-set! biome-names name biome)
        (vector-set! biome-ids id biome)
        (unspecified)))))


(definition public (name->biome name) <Biome>
  (table-ref biome-names name #f))

(definition public (id->biome id <fx>) <Biome>
  (vector-ref biome-ids id))


;;;
;;;; Biomes
;;;


(define-biome Ocean                BiomeOcean          "Ocean"                        0 Grass    Dirt  (0 0 112) base: -1.0 variation: 0.1)
(define-biome Plains               BiomePlains         "Plains"                       1 Grass    Dirt  (141 179 96) base: 0.125 variation: 0.05 temperature: 0.8 rain: 0.4)
(define-biome Desert               BiomeDesert         "Desert"                       2 Sand     Sand  (250 148 24) base: 0.125 variation: 0.05 temperature: 2.0 rain: 0.0)
(define-biome ExtremeHills         BiomeHills          "Extreme Hills"                3 Grass    Dirt  (96 96 96) base: 1.0 variation: 0.5 temperature: 0.2 rain: 0.3)
(define-biome Forest               BiomeForest         "Forest"                       4 Grass    Dirt  (5 102 33) temperature: 0.7 rain: 0.8)
(define-biome Taiga                BiomeTaiga          "Taiga"                        5 Grass    Dirt  (11 102 89) base: 0.2 variation: 0.2 temperature: 0.25 rain: 0.8)
(define-biome Swampland            BiomeSwamp          "Swampland"                    6 Grass    Dirt  (7 249 178) base: -0.2 variation: 0.1 temperature: 0.8 rain: 0.9)
(define-biome River                BiomeRiver          "River"                        7 Grass    Dirt  (0 0 255) base: -0.5 variation: 0.0)
(define-biome Hell                 BiomeHell           "Hell"                         8 Grass    Dirt  (255 0 0) temperature: 2.0 rain: 0.0)
(define-biome Sky                  BiomeEnd            "Sky"                          9 Dirt     Dirt  (128 128 255))
(define-biome FrozenOcean          BiomeOcean          "Frozen Ocean"                10 Grass    Dirt  (144 144 160) base: -1.0 variation: 0.1 temperature: 0.0 rain: 0.5)
(define-biome FrozenRiver          BiomeRiver          "Frozen River"                11 Grass    Dirt  (160 160 255) base: -0.5 variation: 0.0 temperature: 0.0 rain: 0.5)
(define-biome IcePlains            BiomeSnow           "Ice Plains"                  12 Snow     Dirt  (255 255 255) base: 0.125 variation: 0.05 temperature: 0.0 rain: 0.5)
(define-biome IceMountains         BiomeSnow           "Ice Mountains"               13 Snow     Dirt  (160 160 160) base: 0.45 variation: 0.3 temperature: 0.0 rain: 0.5)
(define-biome MushroomIsland       BiomeMushroomIsland "Mushroom Island"             14 Mycelium Dirt  (255 0 255) base: 0.2 variation: 0.3 temperature: 0.9 rain: 1.0)
(define-biome MushroomIslandShore  BiomeMushroomIsland "Mushroom Island Shore"       15 Mycelium Dirt  (160 0 255) base: 0.0 variation: 0.025 temperature: 0.9 rain: 1.0)
(define-biome Beach                BiomeBeach          "Beach"                       16 Sand     Sand  (250 222 85) base: 0.0 variation: 0.025 temperature: 0.8 rain: 0.4)
(define-biome DesertHills          BiomeDesert         "Desert Hills"                17 Sand     Sand  (210 95 18) base: 0.45 variation: 0.3 temperature: 2.0 rain: 0.0)
(define-biome ForestHills          BiomeForest         "Forest Hills"                18 Grass    Dirt  (34 85 28) base: 0.45 variation: 0.3 temperature: 0.7 rain: 0.8)
(define-biome TaigaHills           BiomeTaiga          "Taiga Hills"                 19 Grass    Dirt  (22 57 51) temperature: 0.25 rain: 0.8 base: 0.45 variation: 0.3)
(define-biome ExtremeHillsEdge     BiomeHills          "Extreme Hills Edge"          20 Grass    Dirt  (114 120 154) base: 0.8 variation: 0.3 temperature: 0.2 rain: 0.3)
(define-biome Jungle               BiomeJungle         "Jungle"                      21 Grass    Dirt  (83 123 9) temperature: 0.95 rain: 0.9)
(define-biome JungleHills          BiomeJungle         "Jungle Hills"                22 Grass    Dirt  (44 66 5) base: 0.45 variation: 0.3 temperature: 0.95 rain: 0.9)
(define-biome JungleEdge           BiomeJungle         "Jungle Edge"                 23 Grass    Dirt  (98 139 23) temperature: 0.95 rain: 0.8)
(define-biome DeepOcean            BiomeOcean          "Deep Ocean"                  24 Grass    Dirt  (0 0 48) base: -1.8 variation: 0.1)
(define-biome StoneBeach           BiomeStoneBeach     "Stone Beach"                 25 Stone    Stone (162 162 132) base: 0.1 variation: 0.8 temperature: 0.2 rain: 0.3)
(define-biome ColdBeach            BiomeBeach          "Cold Beach"                  26 Sand     Sand  (250 240 192) base: 0.0 variation: 0.025 temperature: 0.05 rain: 0.3)
(define-biome BirchForest          BiomeForest         "Birch Forest"                27 Grass    Dirt  (48 116 68) temperature: 0.6 rain: 0.6)
(define-biome BirchForestHills     BiomeForest         "Birch Forest Hills"          28 Grass    Dirt  (31 95 50) base: 0.45 variation: 0.3 temperature: 0.6 rain: 0.6)
(define-biome RoofedForest         BiomeForest         "Roofed Forest"               29 Grass    Dirt  (64 81 26) temperature: 0.7 rain: 0.8)
(define-biome ColdTaiga            BiomeTaiga          "Cold Taiga"                  30 Grass    Dirt  (49 85 74) base: 0.2 variation: 0.2 temperature: -0.5 rain: 0.4)
(define-biome ColdTaigaHills       BiomeTaiga          "Cold Taiga Hills"            31 Grass    Dirt  (36 63 54) base: 0.45 variation: 0.3 temperature: -0.5 rain: 0.4)
(define-biome MegaTaiga            BiomeTaiga          "Mega Taiga"                  32 Grass    Dirt  (89 102 81) temperature: 0.3 rain: 0.8 base: 0.2 variation: 0.2)
(define-biome MegaTaigaHills       BiomeTaiga          "Mega Taiga Hills"            33 Grass    Dirt  (69 79 62) base: 0.45 variation: 0.3 temperature: 0.3 rain: 0.8)
(define-biome ExtremeHillsPlus     BiomeHills          "Extreme Hills+"              34 Grass    Dirt  (80 112 80) base: 1.0 variation: 0.5 temperature: 0.2 rain: 0.3)
(define-biome Savanna              BiomeSavanna        "Savanna"                     35 Grass    Dirt  (189 178 95) base: 0.125 variation: 0.05 temperature: 1.2 rain: 0.0)
(define-biome SavannaPlateau       BiomeSavanna        "Savanna Plateau"             36 Grass    Dirt  (167 157 100) base: 1.5 variation: 0.025 temperature: 1.0 rain: 0.0)
(define-biome Mesa                 BiomeMesa           "Mesa"                        37 Grass    Dirt  (217 69 21) temperature: 2.0 rain: 0.0)
(define-biome MesaPlateauF         BiomeMesa           "Mesa Plateau F"              38 Grass    Dirt  (176 151 101) base: 1.5 variation: 0.025 temperature: 2.0 rain: 0.0)
(define-biome MesaPlateau          BiomeMesa           "Mesa Plateau"                39 Grass    Dirt  (202 140 101) base: 1.5 variation: 0.025 temperature: 2.0 rain: 0.0)
(define-biome Void                 BiomeVoid           "Void"                       127 Grass    Dirt  (0 0 0))
(define-biome OceanM               Biome               "Ocean M"                    128 Grass    Dirt  (0 0 112))
(define-biome SunflowerPlains      BiomePlains         "Sunflower Plains"           129 Grass    Dirt  (141 179 96) base: 0.125 variation: 0.05 temperature: 0.8 rain: 0.4)
(define-biome DesertM              BiomeDesert         "Desert M"                   130 Sand     Sand  (250 148 24) base: 0.225 variation: 0.25 temperature: 2.0 rain: 0.0)
(define-biome ExtremeHillsM        BiomeHills          "Extreme Hills M"            131 Grass    Dirt  (96 96 96) base: 1.0 variation: 0.5 temperature: 0.2 rain: 0.3)
(define-biome FlowerForest         BiomeForest         "Flower Forest"              132 Grass    Dirt  (5 102 33) variation: 0.4 temperature: 0.7 rain: 0.8)
(define-biome TaigaM               BiomeTaiga          "Taiga M"                    133 Grass    Dirt  (11 102 89) base: 0.3 variation: 0.4 temperature: 0.25 rain: 0.8)
(define-biome SwamplandM           BiomeSwamp          "Swampland M"                134 Grass    Dirt  (7 249 178) base: -0.1 variation: 0.3 temperature: 0.8 rain: 0.9)
(define-biome RiverM               Biome               "River M"                    135 Grass    Dirt  (0 0 255))
(define-biome HellM                Biome               "Hell M"                     136 Grass    Dirt  (255 0 0))
(define-biome SkyM                 Biome               "Sky M"                      137 Grass    Dirt  (128 128 255))
(define-biome FrozenOceanM         Biome               "Frozen Ocean M"             138 Grass    Dirt  (144 144 160))
(define-biome FrozenRiverM         Biome               "Frozen River M"             139 Grass    Dirt  (160 160 255))
(define-biome IcePlainsSpikes      BiomeSnow           "Ice Plains Spikes"          140 Snow     Dirt  (140 180 180) base: 0.425 variation: 0.45 temperature: 0.0 rain: 0.5)
(define-biome IceMountainsM        Biome               "Ice Mountains M"            141 Grass    Dirt  (160 160 160))
(define-biome MushroomIslandM      Biome               "Mushroom Island M"          142 Grass    Dirt  (255 0 255))
(define-biome MushroomIslandShoreM Biome               "Mushroom Island Shore M"    143 Grass    Dirt  (160 0 255))
(define-biome BeachM               Biome               "Beach M"                    144 Grass    Dirt  (250 222 85))
(define-biome DesertHillsM         Biome               "Desert Hills M"             145 Grass    Dirt  (210 95 18))
(define-biome ForestHillsM         Biome               "Forest Hills M"             146 Grass    Dirt  (34 85 28))
(define-biome TaigaHillsM          Biome               "Taiga Hills M"              147 Grass    Dirt  (22 57 51))
(define-biome ExtremeHillsEdgeM    Biome               "Extreme Hills Edge M"       148 Grass    Dirt  (114 120 154))
(define-biome JungleM              BiomeJungle         "Jungle M"                   149 Grass    Dirt  (83 123 9) base: 0.2 variation: 0.4 temperature: 0.95 rain: 0.9)
(define-biome JungleHillsM         Biome               "Jungle Hills M"             150 Grass    Dirt  (44 66 5))
(define-biome JungleEdgeM          BiomeJungle         "Jungle Edge M"              151 Grass    Dirt  (98 139 23) base: 0.2 variation: 0.4 temperature: 0.95 rain: 0.8)
(define-biome DeepOceanM           Biome               "Deep Ocean M"               152 Grass    Dirt  (0 0 48))
(define-biome StoneBeachM          Biome               "Stone Beach M"              153 Grass    Dirt  (162 162 132))
(define-biome ColdBeachM           Biome               "Cold Beach M"               154 Grass    Dirt  (250 240 192))
(define-biome BirchForestM         BiomeForestMutated  "Birch Forest M"             155 Grass    Dirt  (48 116 68) base: 0.2 variation: 0.4 temperature: 0.6 rain: 0.6)
(define-biome BirchForestHillsM    BiomeForestMutated  "Birch Forest Hills M"       156 Grass    Dirt  (31 95 50) base: 0.55 variation: 0.5 temperature: 0.6 rain: 0.6)
(define-biome RoofedForestM        BiomeForest         "Roofed Forest M"            157 Grass    Dirt  (64 81 26) base: 0.2 variation: 0.4 temperature: 0.7 rain: 0.8)
(define-biome ColdTaigaM           BiomeTaiga          "Cold Taiga M"               158 Grass    Dirt  (49 85 74) base: 0.3 variation: 0.4 temperature: -0.5 rain: 0.4)
(define-biome ColdTaigaHillsM      Biome               "Cold Taiga Hills M"         159 Grass    Dirt  (36 63 54))
(define-biome MegaSpruceTaiga      BiomeTaiga          "Mega Spruce Taiga"          160 Grass    Dirt  (89 102 81) base: 0.2 variation: 0.2 temperature: 0.25 rain: 0.8)
(define-biome MegaSpurceTaigaHills BiomeTaiga          "Mega Spruce Taiga (Hills)"  161 Grass    Dirt  (69 79 62) base: 0.2 variation: 0.2 temperature: 0.25 rain: 0.8)
(define-biome ExtremeHillsPlusM    BiomeHills          "Extreme Hills+ M"           162 Grass    Dirt  (80 112 80) base: 1.0 variation: 0.5 temperature: 0.2 rain: 0.3)
(define-biome SavannaM             BiomeSavannaMutated "Savanna M"                  163 Grass    Dirt  (189 178 95) base: 0.3625 variation: 1.225 temperature: 1.1 rain: 0.0)
(define-biome SavannaPlateauM      BiomeSavannaMutated "Savanna Plateau M"          164 Grass    Dirt  (167 157 100) base: 1.05 variation: 1.2125001 temperature: 1.0 rain: 0.0)
(define-biome MesaBryce            BiomeMesa           "Mesa (Bryce)"               165 Grass    Dirt  (217 69 21) temperature: 2.0 rain: 0.0)
(define-biome MesaPlateauFM        BiomeMesa           "Mesa Plateau F M"           166 Grass    Dirt  (176 151 101) base: 0.45 variation: 0.3 temperature: 2.0 rain: 0.0)
(define-biome MesaPlateauM         BiomeMesa           "Mesa Plateau M"             167 Grass    Dirt  (202 140 101) base: 0.45 variation: 0.3 temperature: 2.0 rain: 0.0)


;;;
;;;; Primary
;;;


(definition public Primary-Biomes
  (vector Ocean Plains Desert ExtremeHills Forest Taiga Swampland Jungle Savanna Mesa)))
