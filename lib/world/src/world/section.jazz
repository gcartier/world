;;;===============
;;;  WorldScheme
;;;===============
;;;
;;;; World Sections
;;;
;;;  The Initial Developer of the Original Code is Guillaume Cartier.
;;;  Portions created by the Initial Developer are Copyright (C) 2012-2016
;;;  the Initial Developer. All Rights Reserved.
;;;
;;;  Contributor(s):


(module world.section jazz


(proclaim (warn optimizations))


(class World-Section extends Object
  
  
  (slot refcount    <fx> initialize 0 getter generate)
  (slot sector                        accessors generate)
  (slot chunk                         getter generate)
  (slot blocks                        getter generate)
  (slot data                          getter generate)
  (slot blocklight                    getter generate)
  (slot skylight                      getter generate)
  
  
  (method override (initialize chunk blocks data blocklight skylight)
    (set! sector~self #f)
    (set! chunk~self chunk)
    (set! blocks~self blocks)
    (set! data~self data)
    (set! blocklight~self blocklight)
    (set! skylight~self skylight))
  
  
  (method (refcount-increase)
    (increase! refcount))
  
  
  (method (refcount-decrease)
    (decrease! refcount)
    (when (<= refcount 0)
      (release)))
  
  
  (method (release)
    ;(debug 'release self)
    (refcount-decrease~ chunk))))
